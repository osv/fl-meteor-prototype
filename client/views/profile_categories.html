<template name="profileCategories">

  <h1>Каталог услуг</h1>

  <p>
    Выберите те услуги которые вы оказываете.

    <div class="checkbox">
      <label>
        <input name="showMine" {{showMine}} type="checkbox"> Показать только выбранное мной.
      </label>
    </div>
  </p>

  <ul>
    {{#each rootCategories }}
      {{> profileCatTreeNode}}
    {{/each }}
  </ul>

</template>


<template name="profileCatTreeNode" >
  {{#if show}}
    <li id="{{_id}}" title="{{n}}">

      {{>profileCatItem ctx=this}}

      {{! если нет p - значит это рут итем}}
      {{#unless p}}
        <ul>
          {{#each children}}
            {{> profileCatTreeNode}}
          {{/each}}
        </ul>
      {{/unless}}
    </li>
  {{/if}}
</template>

<template name="profileCatItem">
  {{#unless ctx.p}}
    <strong>
      {{ctx.n}}
    </strong>
  {{else}}
    {{#if set}}

      <span class="ani-choised">
        {{ctx.n}} (Оказываю)
      </span>
      <button data-action="unset" title="Удалить из выбраных" class="btn btn-xs btn-link">
        <i class="fa fa-trash-o"></i>
      </button>
    {{else}}

      {{ctx.n}}

      <button data-action="set" class="btn btn-xs btn-link">
        <i class="fa fa-plus"></i>
        Выбрать
      </button>
    {{/if}}
  {{/unless}}
  {{! индикатор смены состояния, покачто стандрат. спинер, может лучш будет длругой спинер}}
  {{#if isLoad}}
    {{>spinner}}
  {{/if}}
</template>
